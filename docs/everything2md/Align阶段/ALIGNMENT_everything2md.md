# Everything2MD 项目对齐文档

## 项目概述

Everything2MD 是一个文档转换工具，旨在将各种办公文档格式统一转换为 Markdown 格式，简化文档处理流程，提高文档的可移植性和可编辑性。

## 技术栈和架构

### 核心依赖组件

1. **LibreOffice** ≥ 7.0
   - 用途：打开并转存 .doc/.docx/.ppt 为中间格式（如 HTML），保证样式与结构完整
   
2. **Pandoc** ≥ 3.0
   - 用途：通用文档转换引擎，负责将中间格式统一输出为 Markdown，支持扩展语法
   
3. **pptx2md**（最新 PyPI 版）
   - 用途：专门针对 PPTX 的 Python 解析库，保留母版、备注、层级列表等细节

### 辅助技术

1. **Bash 4+**：脚本运行环境，提供数组/关联数组、进程替换等现代特性，保证 macOS / Linux / WSL 一致体验
2. **Python 3.8+**：可选运行时，用于安装和运行 pptx2md
3. **GNU coreutils / findutils**：批量模式下依赖 xargs、find、stat 等命令进行跨平台文件收集与并行调度

## 现有架构设计

根据技术设计文档，系统采用模块化分层架构：

```
用户输入 → 参数解析器 → 文件类型检测 → 选择转换路径 → 执行转换 → 质量验证 → 输出结果 → 清理临时文件
```

### 核心组件关系

1. **参数解析器**：接收并验证用户输入的命令行参数
2. **文件类型检测**：根据文件扩展名判断处理路径
3. **LibreOffice转换器**：处理 Office 文档(.doc, .docx, .ppt)，转换为 PDF 中间格式
4. **pptx2md转换器**：专门处理 .pptx 文件，直接输出 Markdown
5. **Pandoc转换器**：将 PDF 中间格式转换为 Markdown
6. **直接复制模块**：处理 .txt 和 .md 文件，直接复制
7. **依赖检查系统**：程序启动时验证所需组件是否可用

## 当前项目状态

根据待办事项与后续规划文档以及实际项目结构检查，项目目前尚未开始实际开发。虽然已有详细的需求规格说明书、技术设计文档和待办事项规划，但项目根目录下仅包含文档目录，没有实际的代码实现文件。

### 已完成功能

项目尚未开始实际开发，因此目前没有完成功能。

### 待开发功能

根据待办事项与后续规划文档，以下功能有待开发：

1. **文档转换核心引擎**：开发基础文档转换功能
2. **多格式支持**：实现对常见办公文档格式（.docx, .pptx, .xlsx等）的支持
3. **批量处理**：实现批量文档处理功能
4. **CLI接口**：开发命令行接口
5. **配置管理**：实现基础配置管理功能
6. **PDF处理**：增加对PDF文档的处理支持
7. **图像处理优化**：优化图像处理流程，提高转换质量
8. **性能优化**：优化转换性能
9. **Web界面**：开发Web界面，提供图形化操作界面

## 任务特性规范

### 功能需求
1. 支持多种办公文档格式转换为 Markdown
2. 保持转换质量和格式完整性
3. 提供简单易用的命令行界面
4. 支持批量处理（计划中）
5. 提供配置选项（计划中）

### 非功能需求
1. 性能要求：小文件（<1MB）≤ 10秒，中等文件（1-10MB）≤ 60秒
2. 内存占用：≤ 500MB（单文件）
3. 转换成功率：≥ 95%
4. 跨平台支持：macOS、Linux、Windows（WSL/Git Bash）
5. 可靠性：程序异常退出率 ≤ 1%，数据丢失率 = 0%

### 技术约束
1. 必须使用系统已安装版本的组件，不在项目中包含组件源码
2. 支持 Bash 4.0+ 环境
3. 各组件命令行必须可用